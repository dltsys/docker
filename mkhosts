#!/bin/bash

echo "# Autogenerated" >hosts.new
for N in `sudo docker ps -q`; do
    IP=`sudo docker inspect -f "{{range .NetworkSettings.Networks}}{{.IPAddress}} {{end}}" $N`
    SNAME=`sudo docker inspect -f "{{ .Name }}" $N | sed -re "s/\\///g"`
    if [[ "$SNAME" != "nginx-proxy" ]]; then
        echo $SNAME $N, $IP
        echo "$IP $SNAME" >>hosts.new
        echo "$IP $N" >>hosts.new
    fi
done

rm -f hosts
mv hosts.new hosts
